---
title: 文本格式转换
createTime: 2025/02/27 11:33:07
permalink: /posts/wtgj0iqw/
tags:
- 工具
---
## txt 转 epub

参考：https://bookfere.com/post/82.html

即 重点是目录的匹配

## 关于一些匹配进行目录替换

> 重点针对从 69 下载的txt，匹配方式来自 chatgpt

### 第一步

首先，将:

```
1.第1章 三年 

1.第1章 三年 

第3章 《天下第一》的小皇帝 

第3章 《天下第一》的小皇帝 
```

替换为：

```
第1章 三年 第2章 皇帝专业户的起点

第3章 《天下第一》的小皇帝
```

提问方式：

```
将 两个重复的标题作为一组，即将:

第3章 《天下第一》的小皇帝 

第3章 《天下第一》的小皇帝

作为一组，只剩下最上面的
```

真正的匹配

```
^(?:\d+\.)?(第\d+章 [^\n]+)\n+(?:\d+\.)?\1\n+
```

替换为：

```
$1\n
```

> 需要注意，一定要有 `^` 表示行的开始

具体解释：

- `^(?:\d+\.)?`：匹配可选的章节编号（如 `1.`），非捕获组。
- `(第\d+章 [^\n]+)\n+`：匹配章节标题，并捕获标题，后面跟一个或多个换行符。
- `(?:\d+\.)?`：再次匹配可选的章节编号（如 `1.`），非捕获组。
- `\1\n+`：匹配和捕获的标题相同的第二个章节标题，后面跟一个或多个换行符。
- `$1\n`：只保留第一个章节标题，并在后面加上一个换行符


### 第二步

将：

```
第819章 众生相【为“亡命的家伙”盟主加更】 
2021-01-25   
	
	第819章 众生相【为“亡命的家伙”盟主加更】 

第1章 三年 
2020-11-03   

	第1章 三年
```

修改为：

```
第819章 众生相【为“亡命的家伙”盟主加更】 

第1章 三年
```


匹配方式：

```
^(第\d+章 [^\n]+)\n\d{4}-\d{2}-\d{2}\n\s+第\d+章 [^\n]+\n
```


替换内容：

```
###$1\n
```

具体解释：

- `^(第\d+章 [^\n]+)\n`：匹配章节标题，并捕获标题，后面跟一个换行符。
- `\d{4}-\d{2}-\d{2}\n`：匹配日期格式（如2020-11-03），后面跟一个换行符。
- `\s+第\d+章 [^\n]+\n`：匹配前面有空格的重复章节标题，后面跟一个换行符。
- `$1\n`：只保留第一个章节标题，并在后面加上一个换行符。